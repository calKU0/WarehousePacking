@using KontrolaPakowania.Shared.Enums

<div class="toast-backdrop @( _isVisible ? "show" : "" )" @onclick="Hide">
    <div class="toast-container @ToastClass" @onclick:stopPropagation="true">
        <div class="toast-header-wrapper">
            <strong class="toast-title">@Title</strong>
            <button type="button" class="btn-close btn-close-white toast-close" @onclick="Hide" aria-label="Close"></button>
        </div>
        <div class="toast-body"> @Message</div>
    </div>
</div>



@code {
    private bool _isVisible;
    private System.Timers.Timer? _timer;

    public string Title { get; private set; } = string.Empty;
    public string Message { get; private set; } = string.Empty;
    public ToastType Type { get; private set; } = ToastType.Info;

    private string ToastClass => Type switch
    {
        ToastType.Success => "toast-success",
        ToastType.Error => "toast-error",
        ToastType.Info => "toast-info",
        _ => "toast-info"
    };

    public void Show(string title, string message, ToastType type = ToastType.Error, int autoHideMs = 6000)
    {
        Title = title;
        Message = message;
        Type = type;
        _isVisible = true;

        StateHasChanged();

        _timer?.Stop();
        _timer = new System.Timers.Timer(autoHideMs);
        _timer.Elapsed += (s, e) => InvokeAsync(Hide);
        _timer.AutoReset = false;
        _timer.Start();
    }

    public void Hide()
    {
        _timer?.Stop();
        _isVisible = false;
        StateHasChanged();
    }
}
